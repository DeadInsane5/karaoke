<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>YouTube Song Search</title>
</head>
<body class="w-[100vw] h-[100vh] p-4 bg-gradient-to-br from-purple-600 via-pink-600 to-purple-800 text-white border-0 shadow-2xl overflow-hidden">
    <div class="flex flex-col gap-4">
      <div class="flex justify-end items-center gap-2">
        <h1 class="text-2xl">Search for a Song</h1>
        <input type="text" id="songInput" placeholder="Enter song name" class="p-2 w-[25vw] rounded-lg">
      </div>
      <ul id="resultsList" class="grid grid-cols-3 gap-4"></ul>
    </div>

    <script>
        const API_KEY = 'AIzaSyAG30420Ygj9RY_CdjFrLEiFwfGWrxvvWs'; // Replace with your YouTube Data API key
        const YOUTUBE_API_URL = 'https://www.googleapis.com/youtube/v3/search';
        let debounceTimeout;

        async function searchSongs(query) {
            if (!query) {
                document.getElementById('resultsList').innerHTML = '';
                return;
            }

            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = ''; // Clear previous results

            try {
                const response = await fetch(
                    `${YOUTUBE_API_URL}?part=snippet&maxResults=1&q=${encodeURIComponent(query + ' music video')}&type=video&videoCategoryId=10&key=${API_KEY}`
                );
                const data = await response.json();

                if (data.items && data.items.length > 0) {
                    data.items.forEach(item => {
                        const title = item.snippet.title;
                        const thumbnail = item.snippet.thumbnails.medium.url;

                        const listItem = document.createElement('li');
                        listItem.innerHTML = `
                          <a href="play.html?id=${query}">
                            <div class="card bg-base-100 w-96 shadow-sm p-2">
                              <figure>
                                <img
                                  src="${thumbnail}"
                                  alt="${title}"
                                  class="rounded"
                                />
                              </figure>
                              <div class="card-body">
                                <h2 class="card-title text-black">${title}</h2>
                              </div>
                            </div>
                          </a>
                        `;
                        resultsList.appendChild(listItem);
                    });
                } else {
                    resultsList.innerHTML = '<li>No results found</li>';
                }
            } catch (error) {
                console.error('Error fetching YouTube data:', error);
                resultsList.innerHTML = '<li>Error loading results</li>';
            }
        }

        // Debounce function to limit API calls
        function debounceSearch() {
            const query = document.getElementById('songInput').value.trim();
            clearTimeout(debounceTimeout);
            debounceTimeout = setTimeout(() => {
                searchSongs(query);
            }, 500);
        }

        // Add input event listener for real-time search
        document.getElementById('songInput').addEventListener('input', debounceSearch);
    </script>
</body>
</html>
